<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Main</title><style type="text/css">html,head,body { padding:0; margin:0; }body { font-family: helvetica, arial, sans-serif; }</style></head><body><script type="text/javascript" src="../elm-runtime-0.6.0.3.js"></script><script type="text/javascript">
try{

if (Elm.Main) throw "Module name collision, 'Main' is already defined."; 
Elm.Main=function(){
 var $op={};
 for(Elm['i'] in Elm){eval('var '+Elm['i']+'=Elm[Elm.i];');}
 try{
  if (!(Elm.Prelude instanceof Object)) throw 'module not found';
 } catch(e) {
  throw ("Module 'Prelude' is missing. Compile with --make flag or load missing module in a separate JavaScript file.");
 }
 var hiddenVars={};
 for (Elm['i'] in Elm.Prelude) {
  if (hiddenVars[Elm['i']]) continue;
  eval('var ' + Elm['i'] + ' = Elm.Prelude[Elm.i];');}
 try{
  if (!(Elm.Automaton instanceof Object)) throw 'module not found';
 } catch(e) {
  throw ("Module 'Automaton' is missing. Compile with --make flag or load missing module in a separate JavaScript file.");
 }
 var init_=Elm.Automaton.init_;
 function Fire_0(a1){
  return function(a2){
   return ['Fire',a1,a2];};}
 function GameState_1(a1){
  return ['GameState',a1];}
 function Input_2(a1){
  return function(a2){
   return function(a3){
    return ['Input',a1,a2,a3];};};}
 function updateGame_3(Input$tmouseDownmousePosition_9){
  return function(GameState$oldFires_10){
   return function(){
   switch(Input$tmouseDownmousePosition_9[0]){
    case 'Input':
    return function(){
    switch(GameState$oldFires_10[0]){
     case 'GameState':
     return function(){
      var Tuple2$mouseXmouseY_15=Input$tmouseDownmousePosition_9[3];
      var mouseX_16=function(){
      switch(Tuple2$mouseXmouseY_15[0]){
       case 'Tuple2':
       return Tuple2$mouseXmouseY_15[1];
      }
      throw "Non-exhaustive pattern match in case";}();
      var mouseY_17=function(){
      switch(Tuple2$mouseXmouseY_15[0]){
       case 'Tuple2':
       return Tuple2$mouseXmouseY_15[2];
      }
      throw "Non-exhaustive pattern match in case";}();
      var gameWidth_18=1024;
      var gameHeight_19=768;
      var speed_20=2.0e-2;
      var distanceTravelled_21=truncate((Input$tmouseDownmousePosition_9[1]*speed_20));
      var cityShapes_23=buildings_22(0);
      var headSize_24=div(gameHeight_19)(10);
      var headCenter_25=['Tuple2',div(gameWidth_18)(10),div(gameHeight_19)(4)];
      var headCircle_26=filled(red)(circle(div(gameHeight_19)(10))(headCenter_25));
      var monsterShapes_27=['Cons',headCircle_26,['Nil']];
      var laserShapes_28=(Input$tmouseDownmousePosition_9[2]?['Cons',solid(red)(segment(headCenter_25)(Input$tmouseDownmousePosition_9[3])),['Nil']]:['Nil']);
      var oldVisibleFires_32=filter(fireVisible_30)(GameState$oldFires_10[1]);
      var mouseWorldPosition_33=['Tuple2',(mouseX_16+distanceTravelled_21),mouseY_17];
      var mouseOverBuilding_34=any(isWithin(Input$tmouseDownmousePosition_9[3]))(cityShapes_23);
      var mouseOverFire_35=any(isWithin(Input$tmouseDownmousePosition_9[3]))(map(fireShape_31)(oldVisibleFires_32));
      var newFires_36=((Input$tmouseDownmousePosition_9[2]&&(mouseOverBuilding_34&&not(mouseOverFire_35)))?['Cons',Fire_0(mouseWorldPosition_33)(Input$tmouseDownmousePosition_9[1]),oldVisibleFires_32]:oldVisibleFires_32);
      var newState_37=GameState_1(newFires_36);
      var fireShapes_38=map(fireShape_31)(newFires_36);
      var shapes_39=Value.append(monsterShapes_27,Value.append(cityShapes_23,Value.append(laserShapes_28,fireShapes_38)));
      var newView_40=collage(gameWidth_18)(gameHeight_19)(shapes_39);
      function buildings_22(x_45){
       return function(){
        var bldgWidth_46=div(gameWidth_18)(10);
        var bldgSpace_47=div(bldgWidth_46)(5);
        var bldgStep_48=(bldgWidth_46+bldgSpace_47);
        var bldgOffset_49=(div(bldgWidth_46)(2)-rem(distanceTravelled_21)(bldgStep_48));
        var bldgStagger_50=rem((36969*div((distanceTravelled_21+truncate(x_45)))(bldgStep_48)))(100);
        var bldgHeight_51=(div(gameHeight_19)(10)+bldgStagger_50);
        var building_52=filled(grey)(rect(bldgWidth_46)(bldgHeight_51)(['Tuple2',(x_45+bldgOffset_49),(gameHeight_19-(bldgHeight_51/2))]));
        return ((compare((x_45-bldgWidth_46))(gameWidth_18)[0] === 'GT')?['Nil']:['Cons',building_52,buildings_22(((x_45+bldgWidth_46)+bldgSpace_47))]);}();}
      function fireRadius_29(since_53){
       return (10*(sqrt((Input$tmouseDownmousePosition_9[1]-since_53))*speed_20));}
      function fireVisible_30(Fire$Tuple2$worldXysince_54){
       return function(){
       switch(Fire$Tuple2$worldXysince_54[0]){
        case 'Fire':
        switch(Fire$Tuple2$worldXysince_54[1][0]){
         case 'Tuple2':
         return (compare(Fire$Tuple2$worldXysince_54[1][1])((distanceTravelled_21-fireRadius_29(Fire$Tuple2$worldXysince_54[2])))[0] === 'GT');
        }break;
       }
       throw "Non-exhaustive pattern match in case";}();}
      function fireShape_31(Fire$Tuple2$worldXysince_58){
       return function(){
       switch(Fire$Tuple2$worldXysince_58[0]){
        case 'Fire':
        switch(Fire$Tuple2$worldXysince_58[1][0]){
         case 'Tuple2':
         return function(){
          var radius_62=fireRadius_29(Fire$Tuple2$worldXysince_58[2]);
          var x_63=(Fire$Tuple2$worldXysince_58[1][1]-distanceTravelled_21);
          return filled(red)(circle(radius_62)(['Tuple2',x_63,Fire$Tuple2$worldXysince_58[1][2]]));}();
        }break;
       }
       throw "Non-exhaustive pattern match in case";}();}
      return ['Tuple2',newView_40,newState_37];}();
    }
    throw "Non-exhaustive pattern match in case";}();
   }
   throw "Non-exhaustive pattern match in case";}();};}
 function first_6(Tuple2$ab_64){
  return function(){
  switch(Tuple2$ab_64[0]){
   case 'Tuple2':
   return Tuple2$ab_64[1];
  }
  throw "Non-exhaustive pattern match in case";}();}
 var input_4=lift3(Input_2)(every(0.1))(Mouse.isDown)(Mouse.position);
 var startState_5=GameState_1(['Nil']);
 var gameAutomaton_7=init_(startState_5)(updateGame_3);
 var main_8=Automaton.run(gameAutomaton_7)(input_4);
 return {$op : {},
 Fire:Fire_0,
 GameState:GameState_1,
 Input:Input_2,
 updateGame:updateGame_3,
 input:input_4,
 startState:startState_5,
 first:first_6,
 gameAutomaton:gameAutomaton_7,
 main:main_8};}();
Elm.main=function(){
 return Elm.Main.main;};
} catch (e) {
Elm.main=function() {
var msg = ('<br/><h2>Your browser may not be supported. Are you using a modern browser?</h2>' + '<br/><span style="color:grey">Runtime Error in Main module:<br/>' + e + '<br/><br/>The problem may stem from an improper usage of:<br/>circle, every, init\'</span>');
document.body.innerHTML = Elm.Text.monospace(msg);throw e;};}</script><div id="widthChecker" style="width:100%; height:1px; position:absolute; top:-1px;"></div><div id="content"></div><script type="text/javascript">Dispatcher.initialize()</script><noscript></noscript></body></html>