<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Main</title><style type="text/css">html,head,body { padding:0; margin:0; }body { font-family: helvetica, arial, sans-serif; }</style></head><body><script type="text/javascript" src="elm-runtime-0.7.1.1.js"></script><script type="text/javascript">
try{

if (Elm.Main) throw new Error("Module name collision, 'Main' is already defined."); 
Elm.Main=function(){
 var $op={};
 for(Elm['i'] in Elm){eval('var '+Elm['i']+'=Elm[Elm.i];');}
 try{
  if (!(Elm.Prelude instanceof Object)) throw new Error('module not found');
 } catch(e) {
  throw new Error("Module 'Prelude' is missing. Compile with --make flag or load missing module in a separate JavaScript file.");
 }
 var hiddenVars={};
 for (Elm['i'] in Elm.Prelude) {
  if (hiddenVars[Elm['i']]) continue;
  eval('var ' + Elm['i'] + ' = Elm.Prelude[Elm.i];');}
 try{
  if (!(Elm.Automaton instanceof Object)) throw new Error('module not found');
 } catch(e) {
  throw new Error("Module 'Automaton' is missing. Compile with --make flag or load missing module in a separate JavaScript file.");
 }
 var init$=Elm.Automaton.init$;
 try{
  if (!(Elm.Maybe instanceof Object)) throw new Error('module not found');
 } catch(e) {
  throw new Error("Module 'Maybe' is missing. Compile with --make flag or load missing module in a separate JavaScript file.");
 }
 var hiddenVars={};
 for (Elm['i'] in Elm.Maybe) {
  if (hiddenVars[Elm['i']]) continue;
  eval('var ' + Elm['i'] + ' = Elm.Maybe[Elm.i];');}
 try{
  if (!(Elm.Text instanceof Object)) throw new Error('module not found');
 } catch(e) {
  throw new Error("Module 'Text' is missing. Compile with --make flag or load missing module in a separate JavaScript file.");
 }
 var hiddenVars={};
 for (Elm['i'] in Elm.Text) {
  if (hiddenVars[Elm['i']]) continue;
  eval('var ' + Elm['i'] + ' = Elm.Text[Elm.i];');}
 try{
  if (!(Elm.Graphics instanceof Object)) throw new Error('module not found');
 } catch(e) {
  throw new Error("Module 'Graphics' is missing. Compile with --make flag or load missing module in a separate JavaScript file.");
 }
 var hiddenVars={};
 for (Elm['i'] in Elm.Graphics) {
  if (hiddenVars[Elm['i']]) continue;
  eval('var ' + Elm['i'] + ' = Elm.Graphics[Elm.i];');}
 var Screwdriver_8=['Screwdriver'];
 var Superphone_9=['Superphone'];
 var Knife_10=['Knife'];
 var Office_11=['Office'];
 var Corridor_12=['Corridor'];
 var Infirmary_13=['Infirmary'];
 var EscapePod_14=['EscapePod'];
 var BoughtCake_15=['BoughtCake'];
 function EventOccurred_16(a1){
  return ['EventOccurred',a1];}
 function Have_17(a1){
  return ['Have',a1];}
 function InRoom_18(a1){
  return ['InRoom',a1];}
 var Always_19=['Always'];
 function CondNot_20(a1){
  return ['CondNot',a1];}
 function CondAnd_21(a1){
  return function(a2){
   return ['CondAnd',a1,a2];};}
 function CondOr_22(a1){
  return function(a2){
   return ['CondOr',a1,a2];};}
 var Idle_28=['Idle'];
 function ShowDescription_29(a1){
  return ['ShowDescription',a1];}
 function FadeOutTo_30(a1){
  return ['FadeOutTo',a1];}
 function FadeInTo_31(a1){
  return ['FadeInTo',a1];}
 function ChangeToRoom_32(a1){
  return ['ChangeToRoom',a1];}
 function PickUpItem_33(a1){
  return ['PickUpItem',a1];}
 function UseItem_34(a1){
  return ['UseItem',a1];}
 function indexBy_4(f_60){
  return function(lst_61){
   return Dict.fromList(map(function(v_62){
    return function(){
     var k_63=f_60(v_62);
     return ['Tuple2',k_63,v_62];}();})(lst_61));};}
 function indexById_5(lst_64){
  return indexBy_4(function(x){
   return show(function(r){
    return r.hasOwnProperty('_') ? r.id[0] : r.id;}(x));})(lst_64);}
 function groupBy_6(f_66){
  return function(lst_67){
   return function(){
    function addToGroup_68(v_69){
     return function(dict_70){
      return function(){
       var k_71=f_66(v_69);
       return ['Cons',Dict.insert(k_71)(v_69),Dict.findWithDefault(['Nil'])(k_71)(dict_70)];}();};}
    return List.foldr(addToGroup_68)(Dict.empty)(lst_67);}();};}
 $op['>>>'] = function(f_72){
  return function(g_73){
   return function(x){
    return g_73(f_72(x));};};};
 $op['|>'] = function(x_74){
  return function(g_75){
   return g_75(x_74);};};
 function half_7(x_76){
  return div(x_76)(2);}
 function inRect_36(x_92){
  return function(y_93){
   return function(rect_94){
    return function(){
     var dx_95=(x_92-function(r){
      return r.hasOwnProperty('_') ? r.left[0] : r.left;}(rect_94));
     var dy_96=(y_93-function(r){
      return r.hasOwnProperty('_') ? r.top[0] : r.top;}(rect_94));
     return (function() { var ord = compare(dx_95)(0)[0]; return ord==='GT' || ord==='EQ'; }()&&((compare(dx_95)(function(r){
      return r.hasOwnProperty('_') ? r.width[0] : r.width;}(rect_94))[0] === 'LT')&&(function() { var ord = compare(dy_96)(0)[0]; return ord==='GT' || ord==='EQ'; }()&&(compare(dy_96)(function(r){
      return r.hasOwnProperty('_') ? r.height[0] : r.height;}(rect_94))[0] === 'LT'))));}();};};}
 function headMaybe_37(lst_97){
  return function(){
  switch(lst_97[0]){
   case 'Cons':
   return Just(lst_97[1]);
   case 'Nil':
   return Nothing;
  }
  throw new Error("Non-exhaustive pattern match in case expression (Line 125, Column 17)");}();}
 function find_38(p_99){
  return function(lst_100){
   return function(){
   switch(lst_100[0]){
    case 'Cons':
    return (p_99(lst_100[1])?Just(lst_100[1]):find_38(p_99)(lst_100[2]));
    case 'Nil':
    return Nothing;
   }
   throw new Error("Non-exhaustive pattern match in case expression (Line 129, Column 14)");}();};}
 function findRoom_39(id_103){
  return Dict.findWithDefault(badRoomId_27)(show(id_103))(rooms_26);}
 function findItem_40(id_104){
  return Dict.findWithDefault(badItemId_25)(show(id_104))(items_24);}
 function tryInTurn_41(defaultValue_105){
  return function(flist_106){
   return function(){
   switch(flist_106[0]){
    case 'Cons':
    return function(){
    var case9=flist_106[1](['Tuple0']);
    switch(case9[0]){
     case 'Just':
     return case9[1];
     case 'Nothing':
     return tryInTurn_41(defaultValue_105)(flist_106[2]);
    }
    throw new Error("Non-exhaustive pattern match in case expression (Line 139, Column 17)");}();
    case 'Nil':
    return defaultValue_105;
   }
   throw new Error("Non-exhaustive pattern match in case expression (Line 137, Column 5)");}();};}
 function maybeMap_42(f_110){
  return function(x_111){
   return function(){
   switch(x_111[0]){
    case 'Just':
    return Just(f_110(x_111[1]));
    case 'Nothing':
    return Nothing;
   }
   throw new Error("Non-exhaustive pattern match in case expression (Line 143, Column 5)");}();};}
 function offsetBy_48(_0_113){
  return function(elt_114){
   return function(){
    var left_115=function(r){
     return r.hasOwnProperty('_') ? r.left[0] : r.left;}(_0_113);
    var top_116=function(r){
     return r.hasOwnProperty('_') ? r.top[0] : r.top;}(_0_113);
    return function(){
     var width_117=(left_115+widthOf(elt_114));
     var height_118=(top_116+heightOf(elt_114));
     var location_119=topLeftAt(absolute(left_115))(absolute(top_116));
     return container(width_117)(height_118)(location_119)(elt_114);}();}();};}
 function paddedBy_50(_0_120){
  return function(elt_121){
   return function(){
    var left_122=function(r){
     return r.hasOwnProperty('_') ? r.left[0] : r.left;}(_0_120);
    var top_123=function(r){
     return r.hasOwnProperty('_') ? r.top[0] : r.top;}(_0_120);
    var right_124=function(r){
     return r.hasOwnProperty('_') ? r.right[0] : r.right;}(_0_120);
    var bottom_125=function(r){
     return r.hasOwnProperty('_') ? r.bottom[0] : r.bottom;}(_0_120);
    return function(){
     var location_126=topLeftAt(absolute(left_122))(absolute(top_123));
     var width_127=((left_122+widthOf(elt_121))+right_124);
     var height_128=((top_123+heightOf(elt_121))+bottom_125);
     return container(width_127)(height_128)(location_126)(elt_121);}();}();};}
 function nthMaybe_51(n_129){
  return function(lst_130){
   return function(){
   switch(lst_130[0]){
    case 'Cons':
    return (eq(n_129,0)?Just(lst_130[1]):nthMaybe_51((n_129-1))(lst_130[2]));
    case 'Nil':
    return Nothing;
   }
   throw new Error("Non-exhaustive pattern match in case expression (Line 188, Column 5)");}();};}
 function centerIn_52(bw_133){
  return function(bh_134){
   return function(elt_135){
    return function(){
     var ew_136=widthOf(elt_135);
     var pl_137=div((bw_133-ew_136))(2);
     var pr_138=((bw_133-ew_136)-pl_137);
     var eh_139=heightOf(elt_135);
     var pt_140=div((bh_134-eh_139))(2);
     var pb_141=((bh_134-eh_139)-pt_140);
     return paddedBy_50({
       bottom : [pb_141],
       left : [pl_137],
       right : [pr_138],
       top : [pt_140],
       _ : [true]})(elt_135);}();};};}
 function updateGame_55(input_142){
  return function(oldState_143){
   return function(){
    var _0_144=input_142;
    var t_145=function(r){
     return r.hasOwnProperty('_') ? r.t[0] : r.t;}(_0_144);
    var mouse_146=function(r){
     return r.hasOwnProperty('_') ? r.mouse[0] : r.mouse;}(_0_144);
    var clicked_147=function(r){
     return r.hasOwnProperty('_') ? r.clicked[0] : r.clicked;}(mouse_146);
    var oldRoom_149=findRoom_39(function(r){
     return r.hasOwnProperty('_') ? r.room[0] : r.room;}(oldState_143));
    var pickupsNotPickedUp_150=filter(function(p_172){
     return eq(Dict.lookup(show(function(r){
      return r.hasOwnProperty('_') ? r.item[0] : r.item;}(p_172)))(function(r){
      return r.hasOwnProperty('_') ? r.inventory[0] : r.inventory;}(oldState_143)),Nothing);})(function(r){
     return r.hasOwnProperty('_') ? r.pickups[0] : r.pickups;}(oldRoom_149));
    var heldItems_151=Dict.values(function(r){
     return r.hasOwnProperty('_') ? r.inventory[0] : r.inventory;}(oldState_143));
    var newActivity_153=function(){
     var oldActivity_174=function(r){
      return r.hasOwnProperty('_') ? r.activity[0] : r.activity;}(oldState_143);
     function fadeOutTo_175(next_187){
      return FadeOutTo_30({
        endTime : [(t_145+fadeTime_53)],
        next : [next_187],
        startTime : [t_145],
        _ : [true]});}
     function fadeInTo_176(next_188){
      return FadeInTo_31({
        endTime : [(t_145+fadeTime_53)],
        next : [next_188],
        startTime : [t_145],
        _ : [true]});}
     function checkFade_177(_0_189){
      return function(){
      switch(_0_189[0]){
       case 'Tuple0':
       return function(){
       var case17=function(r){
        return r.hasOwnProperty('_') ? r.activity[0] : r.activity;}(oldState_143);
       switch(case17[0]){
        case 'FadeInTo':
        return Just(((compare(function(r){
         return r.hasOwnProperty('_') ? r.endTime[0] : r.endTime;}(case17[1]))(t_145)[0] === 'LT')?function(r){
         return r.hasOwnProperty('_') ? r.next[0] : r.next;}(case17[1]):function(r){
         return r.hasOwnProperty('_') ? r.activity[0] : r.activity;}(oldState_143)));
        case 'FadeOutTo':
        return Just(((compare(function(r){
         return r.hasOwnProperty('_') ? r.endTime[0] : r.endTime;}(case17[1]))(t_145)[0] === 'LT')?function(r){
         return r.hasOwnProperty('_') ? r.next[0] : r.next;}(case17[1]):function(r){
         return r.hasOwnProperty('_') ? r.activity[0] : r.activity;}(oldState_143)));
       }
       return Nothing;}();
      }
      throw new Error("Non-exhaustive pattern match in case expression (Line 218, Column 21)");}();}
     function checkEnteredRoom_178(_0_193){
      return function(){
      switch(_0_193[0]){
       case 'Tuple0':
       return function(){
       switch(oldActivity_174[0]){
        case 'ChangeToRoom':
        return Just(fadeInTo_176(Idle_28));
       }
       return Nothing;}();
      }
      throw new Error("Non-exhaustive pattern match in case expression (Line 223, Column 21)");}();}
     function showDescription_179(text_195){
      return ShowDescription_29({
        endTime : [(t_145+descriptionTime_54)],
        text : [text_195],
        _ : [true]});}
     function checkUseItem_180(_0_196){
      return function(){
      switch(_0_196[0]){
       case 'Tuple0':
       return Nothing;
      }
      throw new Error("Non-exhaustive pattern match in case expression (Line 227, Column 35)");}();}
     function checkMiniGame_181(_0_197){
      return function(){
      switch(_0_197[0]){
       case 'Tuple0':
       return function(){
       switch(oldActivity_174[0]){
        case 'UseItem':
        switch(oldActivity_174[1][0]){
         case 'Superphone':
         return Nothing;
        }break;
       }
       return Nothing;}();
      }
      throw new Error("Non-exhaustive pattern match in case expression (Line 229, Column 21)");}();}
     function checkDoor_182(_0_199){
      return function(){
      switch(_0_199[0]){
       case 'Tuple0':
       return maybeMap_42($op['>>>'](function(__200){
        return function(r){
         return r.hasOwnProperty('_') ? r.targetRoom[0] : r.targetRoom;}(__200);})(function(x){
        return fadeOutTo_175(ChangeToRoom_32(x));}))(findClickedOn_152(function(r){
        return r.hasOwnProperty('_') ? r.doors[0] : r.doors;}(oldRoom_149)));
      }
      throw new Error("Non-exhaustive pattern match in case expression (Line 232, Column 32)");}();}
     function checkPickup_183(_0_201){
      return function(){
      switch(_0_201[0]){
       case 'Tuple0':
       return maybeMap_42($op['>>>'](function(__202){
        return function(r){
         return r.hasOwnProperty('_') ? r.item[0] : r.item;}(__202);})(PickUpItem_33))(findClickedOn_152(pickupsNotPickedUp_150));
      }
      throw new Error("Non-exhaustive pattern match in case expression (Line 233, Column 34)");}();}
     function checkProp_184(_0_203){
      return function(){
      switch(_0_203[0]){
       case 'Tuple0':
       return maybeMap_42($op['>>>'](function(__204){
        return function(r){
         return r.hasOwnProperty('_') ? r.description[0] : r.description;}(__204);})(showDescription_179))(findClickedOn_152(function(r){
        return r.hasOwnProperty('_') ? r.props[0] : r.props;}(oldRoom_149)));
      }
      throw new Error("Non-exhaustive pattern match in case expression (Line 234, Column 32)");}();}
     function checkInventory_185(_0_205){
      return function(){
      switch(_0_205[0]){
       case 'Tuple0':
       return (clicked_147?(underMouse_148(inventoryArea_45)?function(){
        var firstItemLeft_206=((function(r){
         return r.hasOwnProperty('_') ? r.x[0] : r.x;}(mouse_146)-function(r){
         return r.hasOwnProperty('_') ? r.left[0] : r.left;}(inventoryArea_45))-function(r){
         return r.hasOwnProperty('_') ? r.left[0] : r.left;}(function(r){
         return r.hasOwnProperty('_') ? r.item[0] : r.item;}(inventoryArea_45)));
        var invIndex_207=div(firstItemLeft_206)(function(r){
         return r.hasOwnProperty('_') ? r.width[0] : r.width;}(function(r){
         return r.hasOwnProperty('_') ? r.item[0] : r.item;}(inventoryArea_45)));
        return $op['|>'](nthMaybe_51(invIndex_207)(heldItems_151))(maybeMap_42(UseItem_34));}():Nothing):function(){
       switch(oldActivity_174[0]){
        case 'UseItem':
        return Just(oldActivity_174);
       }
       return Nothing;}());
      }
      throw new Error("Non-exhaustive pattern match in case expression (Line 236, Column 21)");}();}
     function checkDescription_186(_0_210){
      return function(){
      switch(_0_210[0]){
       case 'Tuple0':
       return function(){
       switch(oldActivity_174[0]){
        case 'ShowDescription':
        return ((clicked_147||(compare(function(r){
         return r.hasOwnProperty('_') ? r.endTime[0] : r.endTime;}(oldActivity_174[1]))(t_145)[0] === 'LT'))?Nothing:Just(oldActivity_174));
       }
       return Nothing;}();
      }
      throw new Error("Non-exhaustive pattern match in case expression (Line 247, Column 21)");}();}
     return tryInTurn_41(Idle_28)(['Cons',checkFade_177,['Cons',checkMiniGame_181,['Cons',checkEnteredRoom_178,['Cons',checkUseItem_180,['Cons',checkPickup_183,['Cons',checkProp_184,['Cons',checkDoor_182,['Cons',checkInventory_185,['Cons',checkDescription_186,['Nil']]]]]]]]]]);}();
    var newState_154={
      activity : [newActivity_153],
      inventory : [function(){
    switch(newActivity_153[0]){
     case 'PickUpItem':
     return Dict.insert(show(newActivity_153[1]))(newActivity_153[1])(function(r){
      return r.hasOwnProperty('_') ? r.inventory[0] : r.inventory;}(oldState_143));
    }
    return function(r){
     return r.hasOwnProperty('_') ? r.inventory[0] : r.inventory;}(oldState_143);}()],
      lastClick : [(clicked_147?mouse_146:input_142)],
      room : [function(){
    switch(newActivity_153[0]){
     case 'ChangeToRoom':
     return newActivity_153[1];
    }
    return function(r){
     return r.hasOwnProperty('_') ? r.room[0] : r.room;}(oldState_143);}()],
      _ : [true]};
    var newRoom_155=(eq(function(r){
     return r.hasOwnProperty('_') ? r.room[0] : r.room;}(newState_154),function(r){
     return r.hasOwnProperty('_') ? r.room[0] : r.room;}(oldState_143))?oldRoom_149:findRoom_39(function(r){
     return r.hasOwnProperty('_') ? r.room[0] : r.room;}(newState_154)));
    var bg_156=function(r){
     return r.hasOwnProperty('_') ? r.bg[0] : r.bg;}(newRoom_155);
    var bgImage_157=image(function(r){
     return r.hasOwnProperty('_') ? r.width[0] : r.width;}(bg_156))(function(r){
     return r.hasOwnProperty('_') ? r.height[0] : r.height;}(bg_156))(Value.append(Value.str('images/bg/'),function(r){
     return r.hasOwnProperty('_') ? r.image[0] : r.image;}(bg_156)));
    var debugView_158=function(){
     var debugTextView_217=$op['>>>'](show)($op['>>>'](toText)($op['>>>'](Text.color(green))($op['>>>'](Text.monospace)(Graphics.text))));
     var views_218=['Cons',input_142,['Cons',oldState_143,['Cons',newState_154,['Nil']]]];
     return flow(down)(map(debugTextView_217)(views_218));}();
    var dialogView_159=function(){
     var text_219=function(){
     switch(newActivity_153[0]){
      case 'ShowDescription':
      return function(){
       var _0_221=newActivity_153[1];
       var text_222=function(r){
        return r.hasOwnProperty('_') ? r.text[0] : r.text;}(_0_221);
       return text_222;}();
     }
     return Value.str('');}();
     return $op['|>'](text_219)($op['>>>'](toText)($op['>>>'](Text.color(dialogTextColor_46))($op['>>>'](Text.height(1.5))($op['>>>'](Text.typeface(Value.str('\'Trebuchet MS\', Helvetica, sans-serif')))($op['>>>'](centeredText)($op['>>>'](Graphics.width(gameWidth_0))($op['>>>'](Graphics.color(Color.rgba(0)(0)(0)(0.5)))(container(gameWidth_0)(half_7(gameHeight_1))(middle)))))))));}();
    var tipView_160=function(){
     var tipText_225=tryInTurn_41(Value.str(''))(['Cons',checkPickup_224,['Nil']]);
     function checkPickup_224(_0_226){
      return function(){
      switch(_0_226[0]){
       case 'Tuple0':
       return maybeMap_42($op['>>>'](function(__227){
        return function(r){
         return r.hasOwnProperty('_') ? r.label[0] : r.label;}(__227);})(function(y_229){
        return Value.append(Value.str('Pick up '),y_229);}))(find_38(underMouse_148)(pickupsNotPickedUp_150));
      }
      throw new Error("Non-exhaustive pattern match in case expression (Line 291, Column 34)");}();}
     return $op['|>'](tipText_225)($op['>>>'](toText)($op['>>>'](Text.color(dialogTextColor_46))($op['>>>'](Text.height(1))($op['>>>'](Text.typeface(Value.str('\'Trebuchet MS\', Helvetica, sans-serif')))($op['>>>'](centeredText)($op['>>>'](Graphics.width(gameWidth_0))($op['>>>'](Graphics.color(Color.rgba(0)(0)(0)(0.5)))(container(gameWidth_0)(half_7(gameHeight_1))(middle)))))))));}();
    var visibleProps_161=mapMaybe(function(p_230){
     return maybeMap_42(function(img_231){
      return function(){
       var r={_:[true]};
       var e=p_230;
       for(var i in e){r[i]=e[i];}
       r.image=r.image.slice(0);
       r.image[0]=img_231;
       return r;}();})(function(r){
      return r.hasOwnProperty('_') ? r.image[0] : r.image;}(p_230));})(function(r){
     return r.hasOwnProperty('_') ? r.props[0] : r.props;}(oldRoom_149));
    var propViews_163=map(propView_162)(visibleProps_161);
    var pickupViews_164=map(propView_162)(pickupsNotPickedUp_150);
    var inventoryView_165=(eq(function(r){
     return r.hasOwnProperty('_') ? r.inventory[0] : r.inventory;}(newState_154),Dict.empty)?plainText(''):function(){
     var itemIcons_234=flow(right)(List.map($op['>>>'](findItem_40)(itemImage_233))(heldItems_151));
     var itemIconArea_235=offsetBy_48(function(r){
      return r.hasOwnProperty('_') ? r.item[0] : r.item;}(inventoryArea_45))(itemIcons_234);
     var itemBg_236=image(function(r){
      return r.hasOwnProperty('_') ? r.width[0] : r.width;}(inventoryArea_45))(function(r){
      return r.hasOwnProperty('_') ? r.height[0] : r.height;}(inventoryArea_45))(function(r){
      return r.hasOwnProperty('_') ? r.bg[0] : r.bg;}(inventoryArea_45));
     function itemImage_233(item_237){
      return image(function(r){
       return r.hasOwnProperty('_') ? r.width[0] : r.width;}(function(r){
       return r.hasOwnProperty('_') ? r.item[0] : r.item;}(inventoryArea_45)))(function(r){
       return r.hasOwnProperty('_') ? r.height[0] : r.height;}(function(r){
       return r.hasOwnProperty('_') ? r.item[0] : r.item;}(inventoryArea_45)))(Value.append(Value.str('images/icon/'),function(r){
       return r.hasOwnProperty('_') ? r.icon[0] : r.icon;}(item_237)));}
     return layers(['Cons',itemBg_236,['Cons',itemIconArea_235,['Nil']]]);}());
    var bottomUIView_167=container(gameWidth_0)(gameHeight_1)(midBottom)(flow(down)(['Cons',tipView_160,['Cons',offsetBy_48(inventoryArea_45)(inventoryView_165),['Nil']]]));
    var miniGameViews_168=function(){
    switch(newActivity_153[0]){
     case 'UseItem':
     switch(newActivity_153[1][0]){
      case 'Superphone':
      return ['Cons',centerIn_52(gameWidth_0)(gameHeight_1)(image(454)(707)(Value.str('images/ui/superphone.png'))),['Nil']];
     }break;
    }
    return ['Nil'];}();
    var stage_169=layers(['Cons',bgImage_157,Value.append(propViews_163,Value.append(pickupViews_164,['Cons',bottomUIView_167,['Cons',dialogView_159,miniGameViews_168]]))]);
    var view_170=Graphics.color(black)(flow(down)(['Cons',applyFade_166(stage_169),['Cons',debugView_158,['Nil']]]));
    function underMouse_148(obj_171){
     return inRect_36(function(r){
      return r.hasOwnProperty('_') ? r.x[0] : r.x;}(mouse_146))(function(r){
      return r.hasOwnProperty('_') ? r.y[0] : r.y;}(mouse_146))(obj_171);}
    function findClickedOn_152(objs_173){
     return (clicked_147?find_38(underMouse_148)(objs_173):Nothing);}
    function propView_162(p_232){
     return offsetBy_48(p_232)(image(function(r){
      return r.hasOwnProperty('_') ? r.width[0] : r.width;}(p_232))(function(r){
      return r.hasOwnProperty('_') ? r.height[0] : r.height;}(p_232))(Value.append(Value.str('images/props/'),function(r){
      return r.hasOwnProperty('_') ? r.image[0] : r.image;}(p_232))));}
    function applyFade_166(elt_238){
     return function(){
      var alpha_240=function(){
      switch(newActivity_153[0]){
       case 'ChangeToRoom':
       return 0.0;
       case 'FadeInTo':
       return fadeAmount_239(newActivity_153[1]);
       case 'FadeOutTo':
       return (1.0-fadeAmount_239(newActivity_153[1]));
      }
      return 1.0;}();
      function fadeAmount_239(_0_241){
       return function(){
        var next_242=function(r){
         return r.hasOwnProperty('_') ? r.next[0] : r.next;}(_0_241);
        var startTime_243=function(r){
         return r.hasOwnProperty('_') ? r.startTime[0] : r.startTime;}(_0_241);
        var endTime_244=function(r){
         return r.hasOwnProperty('_') ? r.endTime[0] : r.endTime;}(_0_241);
        return ((t_145-startTime_243)/(endTime_244-startTime_243));}();}
      return ((compare(alpha_240)(1.0)[0] === 'LT')?opacity(alpha_240)(elt_238):elt_238);}();}
    return ['Tuple2',view_170,newState_154];}();};}
 function mkinput_56(t_249){
  return function(clicked_250){
   return function(_0_251){
    return function(){
    switch(_0_251[0]){
     case 'Tuple2':
     return function(){
      var r_254={
        mouse : [{
        clicked : [clicked_250],
        x : [_0_251[1]],
        y : [_0_251[2]],
        _ : [true]}],
        t : [t_249],
        _ : [true]};
      return r_254;}();
    }
    throw new Error("Non-exhaustive pattern match in case expression (Line 334, Column 37)");}();};};}
 var gameWidth_0=1024;
 var gameHeight_1=768;
 var xga_2={
   height : [768],
   width : [1024],
   _ : [true]};
 var ico_3={
   height : [100],
   width : [100],
   _ : [true]};
 var itemList_23=['Cons',{
   icon : [Value.str('screwdriver.png')],
   id : [Screwdriver_8],
   _ : [true]},['Cons',{
   icon : [Value.str('superphone.png')],
   id : [Superphone_9],
   _ : [true]},['Cons',{
   icon : [Value.str('knife.png')],
   id : [Knife_10],
   _ : [true]},['Nil']]]];
 var items_24=indexById_5(itemList_23);
 var badItemId_25={
   icon : [Value.str('XXX.png')],
   id : [Screwdriver_8],
   _ : [true]};
 var rooms_26=function(){
  var roomList_77=['Cons',{
    bg : [function(){
   var r={_:[true]};
   var e=xga_2;
   for(var i in e){r[i]=e[i];}
   var v=Value.str('Corridor.jpg');
   if (r.hasOwnProperty('image')) {
    r.image = r.image.slice(0);
    r.image.unshift(v);
   } else { r.image = [v]; }
   return r;}()],
    id : [Corridor_12],
    _ : [true]},['Cons',{
    bg : [function(){
   var r={_:[true]};
   var e=xga_2;
   for(var i in e){r[i]=e[i];}
   var v=Value.str('Infirmary.jpg');
   if (r.hasOwnProperty('image')) {
    r.image = r.image.slice(0);
    r.image.unshift(v);
   } else { r.image = [v]; }
   return r;}()],
    id : [Infirmary_13],
    _ : [true]},['Cons',{
    bg : [function(){
   var r={_:[true]};
   var e=xga_2;
   for(var i in e){r[i]=e[i];}
   var v=Value.str('Escape Pod.jpg');
   if (r.hasOwnProperty('image')) {
    r.image = r.image.slice(0);
    r.image.unshift(v);
   } else { r.image = [v]; }
   return r;}()],
    id : [EscapePod_14],
    _ : [true]},['Cons',{
    bg : [function(){
   var r={_:[true]};
   var e=xga_2;
   for(var i in e){r[i]=e[i];}
   var v=Value.str('Office.jpg');
   if (r.hasOwnProperty('image')) {
    r.image = r.image.slice(0);
    r.image.unshift(v);
   } else { r.image = [v]; }
   return r;}()],
    id : [Office_11],
    _ : [true]},['Nil']]]]];
  var doors_78=['Cons',{
    height : [407],
    left : [473],
    room : [Office_11],
    targetRoom : [Corridor_12],
    top : [99],
    width : [248],
    _ : [true]},['Cons',{
    height : [120],
    left : [140],
    room : [Corridor_12],
    targetRoom : [Office_11],
    top : [320],
    width : [96],
    _ : [true]},['Cons',{
    height : [120],
    left : [770],
    room : [Corridor_12],
    targetRoom : [Infirmary_13],
    top : [320],
    width : [96],
    _ : [true]},['Cons',{
    height : [395],
    left : [665],
    room : [Infirmary_13],
    targetRoom : [Corridor_12],
    top : [232],
    width : [313],
    _ : [true]},['Cons',{
    height : [26],
    left : [305],
    room : [Corridor_12],
    targetRoom : [EscapePod_14],
    top : [469],
    width : [118],
    _ : [true]},['Cons',{
    height : [91],
    left : [294],
    room : [EscapePod_14],
    targetRoom : [Corridor_12],
    top : [139],
    width : [199],
    _ : [true]},['Nil']]]]]]];
  var props_79=['Cons',{
    description : [Value.str('Some kind of display terminal.  Probably displays very useful information; if I only knew how to turn it on!')],
    height : [93],
    image : [Nothing],
    left : [117],
    room : [Office_11],
    top : [249],
    width : [59],
    _ : [true]},['Cons',{
    description : [Value.str('My predecessor.')],
    height : [213],
    image : [Nothing],
    left : [183],
    room : [Office_11],
    top : [316],
    width : [106],
    _ : [true]},['Cons',{
    description : [Value.str('Could they be part of my job here?')],
    height : [390],
    image : [Nothing],
    left : [738],
    room : [Office_11],
    top : [290],
    width : [133],
    _ : [true]},['Cons',{
    description : [Value.str('A cake.  I can\'t eat it.')],
    height : [100],
    image : [Just(Value.str('cake.png'))],
    left : [213],
    room : [Office_11],
    top : [466],
    width : [100],
    _ : [true]},['Cons',{
    description : [Value.str('Looks like the escape pod has already launched!')],
    height : [25],
    image : [Nothing],
    left : [514],
    room : [Corridor_12],
    top : [469],
    width : [111],
    _ : [true]},['Nil']]]]]];
  var pickups_80=['Cons',{
    height : [100],
    image : [Value.str('ScrewDriver_1_screen.png')],
    item : [Screwdriver_8],
    label : [Value.str('screw driver')],
    left : [190],
    room : [Office_11],
    top : [291],
    width : [100],
    _ : [true]},['Cons',{
    height : [100],
    image : [Value.str('phone_pocket.png')],
    item : [Superphone_9],
    label : [Value.str('phone')],
    left : [169],
    room : [Office_11],
    top : [379],
    width : [100],
    _ : [true]},['Cons',{
    height : [111],
    image : [Value.str('cake_knife.png')],
    item : [Knife_10],
    label : [Value.str('cake with knife')],
    left : [202],
    room : [Office_11],
    top : [465],
    width : [133],
    _ : [true]},['Nil']]]];
  function aug_81(r_82){
   return function(){
    var r1_84=function(){
     var r={_:[true]};
     var e=r_82;
     for(var i in e){r[i]=e[i];}
     var v=flt_83(r_82)(doors_78);
     if (r.hasOwnProperty('doors')) {
      r.doors = r.doors.slice(0);
      r.doors.unshift(v);
     } else { r.doors = [v]; }
     return r;}();
    var r2_85=function(){
     var r={_:[true]};
     var e=r1_84;
     for(var i in e){r[i]=e[i];}
     var v=flt_83(r_82)(props_79);
     if (r.hasOwnProperty('props')) {
      r.props = r.props.slice(0);
      r.props.unshift(v);
     } else { r.props = [v]; }
     return r;}();
    var r3_86=function(){
     var r={_:[true]};
     var e=r2_85;
     for(var i in e){r[i]=e[i];}
     var v=flt_83(r_82)(pickups_80);
     if (r.hasOwnProperty('pickups')) {
      r.pickups = r.pickups.slice(0);
      r.pickups.unshift(v);
     } else { r.pickups = [v]; }
     return r;}();
    function flt_83(r_87){
     return function(lst_88){
      return List.filter($op['>>>'](function(__89){
       return function(r){
        return r.hasOwnProperty('_') ? r.room[0] : r.room;}(__89);})(function(x_90){
       return function(y_91){
        return eq(x_90,y_91);};}(function(r){
       return r.hasOwnProperty('_') ? r.id[0] : r.id;}(r_87))))(lst_88);};}
    return r3_86;}();}
  return indexById_5(map(aug_81)(roomList_77));}();
 var badRoomId_27={
   bg : [function(){
  var r={_:[true]};
  var e=xga_2;
  for(var i in e){r[i]=e[i];}
  var v=Value.str('Missing.jpg');
  if (r.hasOwnProperty('image')) {
   r.image = r.image.slice(0);
   r.image.unshift(v);
  } else { r.image = [v]; }
  return r;}()],
   doors : [['Nil']],
   id : [Office_11],
   pickups : [['Nil']],
   props : [['Nil']],
   _ : [true]};
 var startState_35={
   activity : [Idle_28],
   dialog : [Nothing],
   fade : [0],
   inventory : [Dict.empty],
   lastClick : [{
   _ : [true]}],
   room : [Office_11],
   showingInventory : [true],
   _ : [true]};
 var inventoryWidth_43=809;
 var inventoryHeight_44=106;
 var inventoryArea_45={
   bg : [Value.str('images/ui/inventorybg.png')],
   height : [inventoryHeight_44],
   item : [{
   height : [100],
   left : [3],
   top : [3],
   width : [100],
   _ : [true]}],
   left : [div((gameWidth_0-inventoryWidth_43))(2)],
   top : [(gameHeight_1-inventoryHeight_44)],
   width : [inventoryWidth_43],
   _ : [true]};
 var dialogTextColor_46=Color.rgb(220)(220)(220);
 var noOffset_47={
   left : [0],
   top : [0],
   _ : [true]};
 var noPadding_49={
   bottom : [0],
   left : [0],
   right : [0],
   top : [0],
   _ : [true]};
 var fadeTime_53=500;
 var descriptionTime_54=5000;
 var input_57=lift3(mkinput_56)(Time.every(0.1))(Mouse.isClicked)(Mouse.position);
 var gameAutomaton_58=init$(startState_35)(updateGame_55);
 var main_59=Automaton.run(gameAutomaton_58)(input_57);
 return {$op : {'>>>' : $op['>>>'], '|>' : $op['|>']},
 gameWidth:gameWidth_0,
 gameHeight:gameHeight_1,
 xga:xga_2,
 ico:ico_3,
 indexBy:indexBy_4,
 indexById:indexById_5,
 groupBy:groupBy_6,
 half:half_7,
 Screwdriver:Screwdriver_8,
 Superphone:Superphone_9,
 Knife:Knife_10,
 Office:Office_11,
 Corridor:Corridor_12,
 Infirmary:Infirmary_13,
 EscapePod:EscapePod_14,
 BoughtCake:BoughtCake_15,
 EventOccurred:EventOccurred_16,
 Have:Have_17,
 InRoom:InRoom_18,
 Always:Always_19,
 CondNot:CondNot_20,
 CondAnd:CondAnd_21,
 CondOr:CondOr_22,
 itemList:itemList_23,
 items:items_24,
 badItemId:badItemId_25,
 rooms:rooms_26,
 badRoomId:badRoomId_27,
 Idle:Idle_28,
 ShowDescription:ShowDescription_29,
 FadeOutTo:FadeOutTo_30,
 FadeInTo:FadeInTo_31,
 ChangeToRoom:ChangeToRoom_32,
 PickUpItem:PickUpItem_33,
 UseItem:UseItem_34,
 startState:startState_35,
 inRect:inRect_36,
 headMaybe:headMaybe_37,
 find:find_38,
 findRoom:findRoom_39,
 findItem:findItem_40,
 tryInTurn:tryInTurn_41,
 maybeMap:maybeMap_42,
 inventoryWidth:inventoryWidth_43,
 inventoryHeight:inventoryHeight_44,
 inventoryArea:inventoryArea_45,
 dialogTextColor:dialogTextColor_46,
 noOffset:noOffset_47,
 offsetBy:offsetBy_48,
 noPadding:noPadding_49,
 paddedBy:paddedBy_50,
 nthMaybe:nthMaybe_51,
 centerIn:centerIn_52,
 fadeTime:fadeTime_53,
 descriptionTime:descriptionTime_54,
 updateGame:updateGame_55,
 mkinput:mkinput_56,
 input:input_57,
 gameAutomaton:gameAutomaton_58,
 main:main_59};}();
Elm.main=function(){
 return Elm.Main.main;};
} catch (e) {
Elm.main=function() {
var msg = ('<br/><h2>Your browser may not be supported. Are you using a modern browser?</h2>' + '<br/><span style="color:grey">Runtime Error in Main module:<br/>' + e + '<br/><br/>The problem may stem from an improper usage of:<br/>Text.color, init\', mapMaybe</span>');
document.body.innerHTML = Elm.Text.monospace(msg);throw e;};}</script><div id="widthChecker" style="width:100%; height:1px; position:absolute; top:-1px;"></div><div id="content"></div><script type="text/javascript">Dispatcher.initialize()</script><noscript><p>images/bg/</p><p></p><p>'Trebuchet MS', Helvetica, sans-serif</p><p>Pick up </p><p></p><p>'Trebuchet MS', Helvetica, sans-serif</p><p>images/props/</p><p></p><p>images/icon/</p><p>images/ui/superphone.png</p></noscript></body></html>