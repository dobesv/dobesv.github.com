<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Main</title><style type="text/css">html,head,body { padding:0; margin:0; }body { font-family: helvetica, arial, sans-serif; }</style></head><body><script type="text/javascript" src="../elm-runtime-0.7.js"></script><script type="text/javascript">
try{

if (Elm.Main) throw "Module name collision, 'Main' is already defined."; 
Elm.Main=function(){
 var $op={};
 for(Elm['i'] in Elm){eval('var '+Elm['i']+'=Elm[Elm.i];');}
 try{
  if (!(Elm.Prelude instanceof Object)) throw 'module not found';
 } catch(e) {
  throw ("Module 'Prelude' is missing. Compile with --make flag or load missing module in a separate JavaScript file.");
 }
 var hiddenVars={};
 for (Elm['i'] in Elm.Prelude) {
  if (hiddenVars[Elm['i']]) continue;
  eval('var ' + Elm['i'] + ' = Elm.Prelude[Elm.i];');}
 try{
  if (!(Elm.Automaton instanceof Object)) throw 'module not found';
 } catch(e) {
  throw ("Module 'Automaton' is missing. Compile with --make flag or load missing module in a separate JavaScript file.");
 }
 var init_=Elm.Automaton.init_;
 try{
  if (!(Elm.Maybe instanceof Object)) throw 'module not found';
 } catch(e) {
  throw ("Module 'Maybe' is missing. Compile with --make flag or load missing module in a separate JavaScript file.");
 }
 var hiddenVars={};
 for (Elm['i'] in Elm.Maybe) {
  if (hiddenVars[Elm['i']]) continue;
  eval('var ' + Elm['i'] + ' = Elm.Maybe[Elm.i];');}
 try{
  if (!(Elm.Text instanceof Object)) throw 'module not found';
 } catch(e) {
  throw ("Module 'Text' is missing. Compile with --make flag or load missing module in a separate JavaScript file.");
 }
 var hiddenVars={};
 for (Elm['i'] in Elm.Text) {
  if (hiddenVars[Elm['i']]) continue;
  eval('var ' + Elm['i'] + ' = Elm.Text[Elm.i];');}
 function inRect_13(x_20){
  return function(y_21){
   return function(rect_22){
    return function(){
     var dx_23=(x_20-function(r){
      return r.hasOwnProperty('_') ? r.left[0] : r.left;}(rect_22));
     var dy_24=(y_21-function(r){
      return r.hasOwnProperty('_') ? r.top[0] : r.top;}(rect_22));
     return (function() { var ord = compare(dx_23)(0)[0]; return ord==='GT' || ord==='EQ'; }()&&((compare(dx_23)(function(r){
      return r.hasOwnProperty('_') ? r.width[0] : r.width;}(rect_22))[0] === 'LT')&&(function() { var ord = compare(dy_24)(0)[0]; return ord==='GT' || ord==='EQ'; }()&&(compare(dy_24)(function(r){
      return r.hasOwnProperty('_') ? r.height[0] : r.height;}(rect_22))[0] === 'LT'))));}();};};}
 function headMaybe_14(lst_25){
  return function(){
  switch(lst_25[0]){
   case 'Cons':
   return Just(lst_25[1]);
   case 'Nil':
   return Nothing;
  }
  throw "Non-exhaustive pattern match in case expression (Line 55, Column 17)";}();}
 function updateGame_15(input_27){
  return function(oldState_28){
   return function(){
    var clicked_29=function(r){
     return r.hasOwnProperty('_') ? r.clicked[0] : r.clicked;}(function(r){
     return r.hasOwnProperty('_') ? r.mouse[0] : r.mouse;}(input_27));
    var mouseX_30=function(r){
     return r.hasOwnProperty('_') ? r.x[0] : r.x;}(function(r){
     return r.hasOwnProperty('_') ? r.mouse[0] : r.mouse;}(input_27));
    var mouseY_31=function(r){
     return r.hasOwnProperty('_') ? r.y[0] : r.y;}(function(r){
     return r.hasOwnProperty('_') ? r.mouse[0] : r.mouse;}(input_27));
    var clickedDoorActivities_37=map(clickedDoorActivity_36)(filterClickedOn_35(doors_8));
    var clickedPropActivities_39=map(clickedPropActivity_38)(filterClickedOn_35(props_9));
    var defaultActivity_40=(clicked_29?idle_10:function(r){
     return r.hasOwnProperty('_') ? r.activity[0] : r.activity;}(oldState_28));
    var activity_41=head(Value.append(clickedPropActivities_39,Value.append(clickedDoorActivities_37,['Cons',defaultActivity_40,['Nil']])));
    var newState_46=doChangeRoom_42(doShowDescription_43(rememberActivity_45(rememberLastClick_44(oldState_28))));
    var room_47=function(r){
     return r.hasOwnProperty('_') ? r.room[0] : r.room;}(newState_46);
    var bg_48=function(r){
     return r.hasOwnProperty('_') ? r.bg[0] : r.bg;}(room_47);
    var t_49=function(r){
     return r.hasOwnProperty('_') ? r.t[0] : r.t;}(input_27);
    var bgImage_50=image(function(r){
     return r.hasOwnProperty('_') ? r.width[0] : r.width;}(bg_48))(function(r){
     return r.hasOwnProperty('_') ? r.height[0] : r.height;}(bg_48))(Value.append(Value.str('images/bg/'),function(r){
     return r.hasOwnProperty('_') ? r.image[0] : r.image;}(bg_48)));
    var debugView_51=flow(down)(map(function(x){
     return plainText(show(x));})(['Cons',input_27,['Cons',oldState_28,['Cons',newState_46,['Nil']]]]));
    var dialogView_52=width(gameWidth_0)(centeredText(Text.color(white)(toText(fromMaybe(Value.str('(no dialog)'))(function(r){
     return r.hasOwnProperty('_') ? r.dialog[0] : r.dialog;}(newState_46))))));
    var view_53=flow(down)(['Cons',layers(['Cons',bgImage_50,['Cons',dialogView_52,['Nil']]]),['Cons',debugView_51,['Nil']]]);
    function inThisRoom_32(obj_54){
     return eq(function(r){
      return r.hasOwnProperty('_') ? r.room[0] : r.room;}(obj_54),function(r){
      return r.hasOwnProperty('_') ? r.room[0] : r.room;}(oldState_28));}
    function inRectInThisRoom_33(x_55){
     return function(y_56){
      return function(obj_57){
       return (inThisRoom_32(obj_57)&&inRect_13(x_55)(y_56)(obj_57));};};}
    function clickedOnInThisRoom_34(obj_58){
     return inRectInThisRoom_33(mouseX_30)(mouseY_31)(obj_58);}
    function filterClickedOn_35(objs_59){
     return (clicked_29?filter(clickedOnInThisRoom_34)(objs_59):['Nil']);}
    function clickedDoorActivity_36(door_60){
     return function(){
      var r={_:[true]};
      var e=idle_10;
      for(var i in e){r[i]=e[i];}
      r.changeToRoom=r.changeToRoom.slice(0);
      r.changeToRoom[0]=Just(function(r){
       return r.hasOwnProperty('_') ? r.targetRoom[0] : r.targetRoom;}(door_60));
      return r;}();}
    function clickedPropActivity_38(prop_61){
     return function(){
      var r={_:[true]};
      var e=idle_10;
      for(var i in e){r[i]=e[i];}
      r.showDescription=r.showDescription.slice(0);
      r.showDescription[0]=headMaybe_14(function(r){
       return r.hasOwnProperty('_') ? r.descriptions[0] : r.descriptions;}(prop_61));
      return r;}();}
    function doChangeRoom_42(oldState_62){
     return maybe(oldState_62)(function(room_63){
      return function(){
       var r={_:[true]};
       var e=oldState_62;
       for(var i in e){r[i]=e[i];}
       r.room=r.room.slice(0);
       r.room[0]=room_63;
       r.activity=r.activity.slice(0);
       r.activity[0]=idle_10;
       return r;}();})(function(r){
      return r.hasOwnProperty('_') ? r.changeToRoom[0] : r.changeToRoom;}(activity_41));}
    function doShowDescription_43(oldState_64){
     return function(){
      var r={_:[true]};
      var e=oldState_64;
      for(var i in e){r[i]=e[i];}
      r.dialog=r.dialog.slice(0);
      r.dialog[0]=function(r){
       return r.hasOwnProperty('_') ? r.showDescription[0] : r.showDescription;}(activity_41);
      return r;}();}
    function rememberLastClick_44(oldState_65){
     return (clicked_29?function(){
      var r={_:[true]};
      var e=oldState_65;
      for(var i in e){r[i]=e[i];}
      r.lastClick=r.lastClick.slice(0);
      r.lastClick[0]=activity_41;
      return r;}():oldState_65);}
    function rememberActivity_45(oldState_66){
     return function(){
      var r={_:[true]};
      var e=oldState_66;
      for(var i in e){r[i]=e[i];}
      r.activity=r.activity.slice(0);
      r.activity[0]=activity_41;
      return r;}();}
    return ['Tuple2',view_53,newState_46];}();};}
 function mkinput_16(t_67){
  return function(clicked_68){
   return function(a0_69){
    return function(){
    switch(a0_69[0]){
     case 'Tuple2':
     return function(){
      var r_72={
        mouse : [{
        clicked : [clicked_68],
        x : [a0_69[1]],
        y : [a0_69[2]],
        _ : [true]}],
        t : [t_67],
        _ : [true]};
      return r_72;}();
    }
    throw "Non-exhaustive pattern match in case expression (Line 86, Column 37)";}();};};}
 var gameWidth_0=1024;
 var gameHeight_1=768;
 var xga_2={
   height : [768],
   width : [1024],
   _ : [true]};
 var ico_3={
   height : [100],
   width : [100],
   _ : [true]};
 var office_4={
   bg : [function(){
  var r={_:[true]};
  var e=xga_2;
  for(var i in e){r[i]=e[i];}
  var v=Value.str('Office.jpg');
  if (r.hasOwnProperty('image')) {
   r.image = r.image.slice(0);
   r.image.unshift(v);
  } else { r.image = [v]; }
  return r;}()],
   _ : [true]};
 var corridor_5={
   bg : [function(){
  var r={_:[true]};
  var e=xga_2;
  for(var i in e){r[i]=e[i];}
  var v=Value.str('Corridor.jpg');
  if (r.hasOwnProperty('image')) {
   r.image = r.image.slice(0);
   r.image.unshift(v);
  } else { r.image = [v]; }
  return r;}()],
   _ : [true]};
 var infirmary_6={
   bg : [function(){
  var r={_:[true]};
  var e=xga_2;
  for(var i in e){r[i]=e[i];}
  var v=Value.str('Infirmary.jpg');
  if (r.hasOwnProperty('image')) {
   r.image = r.image.slice(0);
   r.image.unshift(v);
  } else { r.image = [v]; }
  return r;}()],
   _ : [true]};
 var escapePod_7={
   bg : [function(){
  var r={_:[true]};
  var e=xga_2;
  for(var i in e){r[i]=e[i];}
  var v=Value.str('Escape Pod.jpg');
  if (r.hasOwnProperty('image')) {
   r.image = r.image.slice(0);
   r.image.unshift(v);
  } else { r.image = [v]; }
  return r;}()],
   _ : [true]};
 var doors_8=['Cons',{
   height : [407],
   left : [473],
   room : [office_4],
   targetRoom : [corridor_5],
   top : [99],
   width : [248],
   _ : [true]},['Cons',{
   height : [120],
   left : [140],
   room : [corridor_5],
   targetRoom : [office_4],
   top : [320],
   width : [96],
   _ : [true]},['Cons',{
   height : [120],
   left : [770],
   room : [corridor_5],
   targetRoom : [infirmary_6],
   top : [320],
   width : [96],
   _ : [true]},['Cons',{
   height : [395],
   left : [665],
   room : [infirmary_6],
   targetRoom : [corridor_5],
   top : [232],
   width : [313],
   _ : [true]},['Cons',{
   height : [28],
   left : [538],
   room : [corridor_5],
   targetRoom : [escapePod_7],
   top : [433],
   width : [73],
   _ : [true]},['Cons',{
   height : [91],
   left : [294],
   room : [escapePod_7],
   targetRoom : [corridor_5],
   top : [139],
   width : [199],
   _ : [true]},['Nil']]]]]]];
 var props_9=['Cons',{
   descriptions : [['Cons',Value.str('Some kind of display terminal.  Probably displays very useful information; if I only knew how to turn it on!'),['Nil']]],
   height : [93],
   left : [212],
   room : [office_4],
   top : [247],
   width : [59],
   _ : [true]},['Cons',{
   descriptions : [['Cons',Value.str('My predecessor.'),['Nil']]],
   height : [75],
   left : [297],
   room : [office_4],
   top : [303],
   width : [75],
   _ : [true]},['Cons',{
   descriptions : [['Cons',Value.str('Those instruments look very unique.  Could they be part of my job here?'),['Nil']]],
   height : [390],
   left : [738],
   room : [office_4],
   top : [290],
   width : [133],
   _ : [true]},['Cons',{
   descriptions : [['Cons',Value.str('Looks like the escape pod has already launched.'),['Nil']]],
   height : [25],
   left : [301],
   room : [corridor_5],
   top : [437],
   width : [73],
   _ : [true]},['Nil']]]]];
 var idle_10={
   changeToRoom : [Nothing],
   showDescription : [Nothing],
   walkTo : [Nothing],
   _ : [true]};
 var items_11=['Cons',{
   icon : [Value.str('ScrewDriver_1_inventory.png')],
   _ : [true]},['Nil']];
 var startState_12={
   activity : [idle_10],
   dialog : [Nothing],
   lastClick : [{
   _ : [true]}],
   room : [office_4],
   showingInventory : [true],
   _ : [true]};
 var input_17=lift3(mkinput_16)(Time.every(0.1))(Mouse.isClicked)(Mouse.position);
 var gameAutomaton_18=init_(startState_12)(updateGame_15);
 var main_19=Automaton.run(gameAutomaton_18)(input_17);
 return {$op : {},
 gameWidth:gameWidth_0,
 gameHeight:gameHeight_1,
 xga:xga_2,
 ico:ico_3,
 office:office_4,
 corridor:corridor_5,
 infirmary:infirmary_6,
 escapePod:escapePod_7,
 doors:doors_8,
 props:props_9,
 idle:idle_10,
 items:items_11,
 startState:startState_12,
 inRect:inRect_13,
 headMaybe:headMaybe_14,
 updateGame:updateGame_15,
 mkinput:mkinput_16,
 input:input_17,
 gameAutomaton:gameAutomaton_18,
 main:main_19};}();
Elm.main=function(){
 return Elm.Main.main;};
} catch (e) {
Elm.main=function() {
var msg = ('<br/><h2>Your browser may not be supported. Are you using a modern browser?</h2>' + '<br/><span style="color:grey">Runtime Error in Main module:<br/>' + e + '<br/><br/>The problem may stem from an improper usage of:<br/>Text.color, init\'</span>');
document.body.innerHTML = Elm.Text.monospace(msg);throw e;};}</script><div id="widthChecker" style="width:100%; height:1px; position:absolute; top:-1px;"></div><div id="content"></div><script type="text/javascript">Dispatcher.initialize()</script><noscript><p>images/bg/</p><p>(no dialog)</p></noscript></body></html>